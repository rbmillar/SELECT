dir()
install.package("./FDR")
library(FDR)
library("./FDR")
install.packages("./FDR")
ls()
FDR
library(FDR)
usethis
glmmTMB
create_package
usethis::create_package("./BootstrapHauls")
usethis::use.package("data.table")
usethis::use_package("data.table")
?usethis
usethis::create_package("./SplineNCAP")
install.packages(c("backports", "bootstrap", "callr", "car", "carData", "cli", "clipr", "curl", "data.table", "devtools", "digest", "doParallel", "dplyr", "ellipsis", "foreach", "ggplot2", "gmm", "haven", "Hmisc", "hms", "htmlTable", "htmltools", "htmlwidgets", "httpuv", "httr", "iterators", "KernSmooth", "knitr", "later", "maptools", "markdown", "modelr", "MuMIn", "openssl", "openxlsx", "pillar", "pkgbuild", "pkgconfig", "plyr", "processx", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppArmadillo", "RcppEigen", "rgl", "rlang", "rmarkdown", "roxygen2", "rvest", "scales", "selectr", "shiny", "sp", "sys", "testthat", "tidyr", "tidyverse", "tinytex", "vctrs", "VGAM", "webshot", "whisker", "xfun", "xml2", "zip"))
?use_package
usethis::create_package("SplineCAP")
View(D)
install.packages("usethis")
library(usethis)
library(installr)
updateR()
source("T:/Russell_SSD/ACTIVE/CurrentWork/RPackages/SELECT/R/BOOTSTRAP&PERMUTATION.R")
knitr::opts_chunk$set(fig.height = 3.5)
#remotes::install_github("rbmillar/SELECT")
require(tidyverse)
require(mgcv)
require(SELECT)
require(readxl) #This package is installed with tidyverse
nsim=1000 #For bootstrapping and permutation tests, set to >=999 in practice
GearA.df=read_excel("SchoolPrawnLenFreqs.xlsx", sheet = "32 square trawl")
GearB.df=read_excel("SchoolPrawnLenFreqs.xlsx", sheet = "35 square trawl")
#The "Day" variable is actually the unique haul-pair identifier
GearA.df = GearA.df |> rename(Haul=Day, nA=No.school, sfA=Sf.school)
GearB.df = GearB.df |> rename(Haul=Day, nB=No.school, sfB=Sf.school)
#Merge the gears with the same identical haul-pair ID (i.e., twin tows)
Pairs.df = inner_join(GearA.df,GearB.df,by=c("Haul","CL"))
#Convert scaling factors to sampling fractions
Pairs.df = Pairs.df |>
transform(qA=1/sfA,qB=1/sfB) |> filter(CL>=5 & CL<=25)
#write.csv(Pairs.df,"Pairs.RData",row.names=F)
names(Pairs.df)
vNames=c("CL","nA","nB")
qNames=c("qA","qB")
#Define the bootstrap prediction function
CLseq=5:23 #Carapace lengths to use for predn
PrednFnc=function(data,var.names,q.names) {
SplineFit=SplineSELECT(data,var.names,q.names) #Using spline defaults
predict(SplineFit,newdata=data.frame(CL=CLseq),type="response") }
#Check that it works
predn=PrednFnc(Pairs.df,vNames,qNames)
#Plot predictions against observed proportions
Tots.df=Raw2Tots(Pairs.df,vNames,qNames) |>
transform(lgth=CL, y=nB/(nA+nB))
plot(y~CL,data=Tots.df,ylim=c(0,1),xlab="Carapace length (mm)",
ylab="Gear B catch share")
points(CLseq,predn,type="l")
abline(h=0.5,lty=3)
BootPreds=bootSELECT(Pairs.df,vNames,qNames,PrednFnc,haul="Haul",nsim=nsim,
paired=T,verbose=T) #Use verbose=T to see progress
BootPlot(BootPreds,CLseq,predn,Data=Tots.df) +
geom_hline(yintercept=0.5,linetype="dashed")
BootPlot(BootPreds,CLseq,predn,Data=Tots.df) +
geom_hline(yintercept=0.5,linetype="dashed")
BootPlot(BootPreds,CLseq,predn,Data=Tots.df) +
geom_hline(yintercept=0.5,linetype="dashed")
#With pointwise confidence band also shown
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T) +
+geom_hline(yintercept=0.45,linetype="dashed")
#With pointwise confidence band also shown
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T) +
geom_hline(yintercept=0.45,linetype="dashed")
#Setting limits to include only lengths where >30 prawn caught
#This reduces the number of multiple comparisons
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T,
limits=c(9,21)) +
geom_hline(yintercept=0.5,linetype="dashed")
#With pointwise confidence band also shown
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T) +
geom_hline(yintercept=0.45,linetype="dashed")
#Setting limits to include only lengths where >30 prawn caught
#This reduces the number of multiple comparisons
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T,
limits=c(9,21)) +
geom_hline(yintercept=0.5,linetype="dashed")
#Setting limits to include only lengths where >30 prawn caught
#This reduces the number of multiple comparisons
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T,
limits=c(9,21)) +
geom_hline(yintercept=0.5,linetype="dashed")
#Setting limits to include only lengths where >30 prawn caught
#This reduces the number of multiple comparisons
SimPlot=BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T,
limits=c(9,21)) +
geom_hline(yintercept=0.5,linetype="dashed")
BootPlot(BootPreds,CLseq,predn,Data=Tots.df) +
geom_hline(yintercept=0.5,linetype="dashed")
#With pointwise confidence band also shown
BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T) +
geom_hline(yintercept=0.45,linetype="dashed")
#Setting limits to include only lengths where >30 prawn caught
#This reduces the number of multiple comparisons
BootPlot(BootPreds,CLseq,predn,Data=Tots.df,show.pointwise=T,
limits=c(9,21)) +
geom_hline(yintercept=0.5,linetype="dashed")
PkgName="SELECT"
#PkgName="SHOUtoolkit"
#Create package folder structure (and opens 2nd RStudio for the project)
#usethis::create_package(PkgName)
setwd(paste0("T:/Russell_SSD/ACTIVE/CurrentWork/RPackages/",PkgName))
roxygen2::roxygenise() #or devtools::document()
